{"version":3,"file":"bundle.js","sources":["../../src/util/index.js","../../src/observer/array.js","../../src/observer/dep.js","../../src/observer/index.js","../../src/instance/state.js","../../src/compiler/parser/html-parser.js","../../src/compiler/codegen/index.js","../../src/compiler/index.js","../../src/observer/scheduler.js","../../src/observer/watcher.js","../../src/vdom/patch.js","../../src/instance/lifecycle.js","../../src/vdom/create-element.js","../../src/instance/init.js","../../src/instance/render.js","../../src/instance/index.js"],"sourcesContent":["export function isObject(obj) {\n  return obj !== null && typeof obj === 'object';\n}\n\nexport function def(obj, key, val, enumerable) {\n  Object.defineProperty(obj, key, {\n    value: val,\n    enumerable: !!enumerable,\n    writable: true,\n    configurable: true,\n  });\n}\n\nexport function mergeOptions(parent, child) {\n  const options = {};\n  let key;\n\n  for (key in parent) {\n    mergeField(key);\n  }\n\n  for (key in child) {\n    if (!hasOwn(parent, key)) {\n      mergeField(key);\n    }\n  }\n  function mergeField(key) {\n    const strat = strats[key] || defaultStrat;\n    options[key] = strat(parent[key], child[key], vm, key);\n  }\n  return options;\n}\n\nfunction mergeHook(parentVal, childVal) {\n  if (childVal) {\n    if (parentVal) {\n      return parentVal.concat(childVal);\n    } else {\n      if (Array.isArray(childVal)) {\n        return childVal;\n      } else {\n        return [childVal];\n      }\n    }\n  } else {\n    return parentVal;\n  }\n}\n","/**\n * 重写数组的7个方法\n * 'push'、'pop'、'shift'、'unshift'、'splice'、'sort'、'reverse'\n * 这7个方法会导致数组本身发生改变\n * slice 这种不会导致数组本身变化的不作处理\n */\nconst arrayProto = Array.prototype;\nexport const arrayMethods = Object.create(arrayProto);\n\nconst methodsToPatch = [\n  'push',\n  'pop',\n  'shift',\n  'unshift',\n  'splice',\n  'sort',\n  'reverse',\n];\n\nmethodsToPatch.forEach((method) => {\n  const original = arrayProto[method];\n\n  arrayMethods[method] = function (...args) {\n    const result = original.apply(this, args); // 调用原生数组的方法\n    const ob = this.__ob__; // Observer 实例\n    let inserted; // 插入的元素 例如，arr.push(a), inserted = a\n    switch (method) {\n      case 'push':\n      case 'unshift':\n        inserted = args;\n        break;\n      case 'splice': // 有三个参数，删除|新增 arr.splice(0, 1 , {name: 1})\n        inserted = args.slice(2);\n        break;\n    }\n    /**\n     * observe新添加的数据\n     */\n    if (inserted) ob.observeArray(inserted);\n    ob.dep.notify();\n    return result;\n  };\n});\n","let uid = 0;\n\nclass Dep {\n  constructor() {\n    this.id = uid++;\n    this.subs = [];\n  }\n\n  addSub(sub) {\n    this.subs.push(sub); // 观察者模式\n  }\n\n  removeSub(sub) {\n    remove(this.subs, sub);\n  }\n\n  depend() {\n    // 将watcher收集起来\n    if (Dep.target) {\n      Dep.target.addDep(this);\n    }\n  }\n\n  notify() {\n    const subs = this.subs.slice();\n    for (let i = 0, l = subs.length; i < l; i++) {\n      subs[i].update();\n    }\n  }\n}\n\nDep.target = null;\nconst targetStack = [];\n\nexport function pushTarget(watcher) {\n  targetStack.push(watcher);\n  Dep.target = watcher;\n}\n\nexport function popTarget() {\n  targetStack.pop();\n  Dep.target = targetStack[targetStack.length - 1];\n}\n\nexport default Dep;\n","import { isObject, def } from '../util/index';\nimport { arrayMethods } from './array';\nimport Dep from './dep';\n\nexport function observe(value) {\n  if (!isObject(value)) return;\n\n  return new Observer(value); // 观测数据\n}\n\nexport class Observer {\n  constructor(value) {\n    this.dep = new Dep();\n    /**\n     * 给每一个检测过的对象都加一个__ob__属性，换句话说__ob__表示该对象已经被检测过了\n     * 但是 不能用 this.value = value 这种方式，因为 observeArray 时会循环引用，所以\n     * 用def定义响应式， enumerable: false不可以枚举，不会被defineReactive监控\n     */\n    def(value, '__ob__', this);\n\n    if (Array.isArray(value)) {\n      // 利用原型链的方式对数组的'push'、'pop'、'shift'、'unshift'、'splice'、'sort'、'reverse'方法进行重写\n      // 先找重写的，没有再去找原生的\n      value.__proto__ = arrayMethods;\n\n      this.observeArray(value);\n    } else {\n      this.walk(value);\n    }\n  }\n\n  walk(obj) {\n    const keys = Object.keys(obj);\n    keys.forEach((key) => {\n      // 定义响应式数据\n      defineReactive(obj, key, obj[key]);\n    });\n  }\n  observeArray(items) {\n    for (let i = 0, l = items.length; i < l; i++) {\n      observe(items[i]);\n    }\n  }\n}\n\nexport function defineReactive(obj, key, val) {\n  const dep = new Dep();\n  let childOb = observe(val);\n\n  Object.defineProperty(obj, key, {\n    enumerable: true,\n    configurable: true,\n    get: function reactiveGetter() {\n      if (Dep.target) {\n        dep.depend(); // 对象的依赖收集\n        if (childOb) {\n          // 数组的依赖收集\n          // 这里虽然对象，也会进来，但是 this.depIds = new Set()，会过滤调对象的已经保存起来的watcher\n          childOb.dep.depend();\n          if (Array.isArray(val)) {\n            dependArray(val);\n          }\n        }\n      }\n      return val;\n    },\n    set: function reactiveSetter(newVal) {\n      console.log('数据更新');\n      if (val === newVal) return;\n      observe(newVal);\n      val = newVal;\n      dep.notify();\n    },\n  });\n}\n\nfunction dependArray(value) {\n  for (let e, i = 0, l = value.length; i < l; i++) {\n    e = value[i];\n    e && e.__ob__ && e.__ob__.dep.depend();\n    if (Array.isArray(e)) {\n      dependArray(e);\n    }\n  }\n}\n","import { observe } from '../observer/index';\n\nfunction proxy(vm, source, key) {\n  Object.defineProperty(vm, key, {\n    get() {\n      return vm[source][key];\n    },\n    set(newValue) {\n      vm[source][key] = newValue;\n    },\n  });\n}\n\nexport function initState(vm) {\n  const opts = vm.$options;\n\n  if (opts.props) initProps(vm, opts.props);\n  if (opts.methods) initMethods(vm, opts.methods);\n  if (opts.data) {\n    initData(vm);\n  }\n  if (opts.computed) initComputed(vm, opts.computed);\n  if (opts.watch) {\n    initWatch(vm, opts.watch);\n  }\n}\n\nfunction initProps(vm) {}\nfunction initMethods(vm) {}\nfunction initData(vm) {\n  let data = vm.$options.data;\n  data = vm._data = typeof data === 'function' ? data.call(vm, vm) : data || {};\n\n  for (let key in data) {\n    proxy(vm, '_data', key);\n  }\n  // 数据劫持\n  observe(data);\n}\nfunction initComputed(vm) {}\nfunction initWatch(vm) {}\n","const ncname = `[a-zA-Z_][\\\\-\\\\.0-9_a-zA-Z]*`; // aa-aaa\nconst qnameCapture = `((?:${ncname}\\\\:)?${ncname})`; // <aaa:abcd>\nconst startTagOpen = new RegExp(`^<${qnameCapture}`); // 标签开头的正则，捕获的内容是标签内容\nconst startTagClose = /^\\s*(\\/?)>/; // 匹配结束标签>\nconst endTag = new RegExp(`^<\\\\/${qnameCapture}[^>]*>`); // 匹配标签的结尾的 </div>\nconst dynamicArgAttribute = /^\\s*((?:v-[\\w-]+:|@|:|#)\\[[^=]+?\\][^\\s\"'<>\\/=]*)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/;\nconst attribute = /^\\s*([^\\s\"'<>\\/=]+)(?:\\s*(=)\\s*(?:\"([^\"]*)\"+|'([^']*)'+|([^\\s\"'=<>`]+)))?/; // 匹配属性\nconst doctype = /^<!DOCTYPE [^>]+>/i;\nconst comment = /^<!\\--/;\nconst conditionalComment = /^<!\\[/;\nconst defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\nconst regexEscapeRE = /[-.*+?^${}()|[\\]\\/\\\\]/;\n\nexport function parseHTML(html, options) {\n  let root = null;\n  let currentParent = null;\n  let stack = []; // ['div', 'p', 'span', 'span', 'p', 'div',]\n\n  function createASTElement(tag, attrs) {\n    return {\n      type: 1,\n      tag,\n      attrsList: attrs,\n      parent: null,\n      children: [],\n    };\n  }\n\n  function start(tag, attrs) {\n    let element = createASTElement(tag, attrs);\n    if (!root) {\n      root = element;\n    }\n    currentParent = element;\n    stack.push(element);\n  }\n\n  function chars(text) {\n    text = text.replace(/\\s/g, '');\n    if (text) {\n      currentParent.children.push({\n        type: 3,\n        text,\n      });\n    }\n  }\n\n  function end() {\n    const element = stack.pop();\n    currentParent = stack[stack.length - 1];\n\n    /**\n     * parent,children 只能在end的时候确定，不能在start时确认\n     * 只有在end时，才知道时否时闭合标签\n     */\n    if (currentParent) {\n      element.parent = currentParent;\n      currentParent.children.push(element);\n    }\n  }\n\n  while (html) {\n    let testEnd = html.indexOf('<');\n    // Start tag: 即，< 处在开始位置\n    if (testEnd === 0) {\n      let startTagMatch = parseStartTag(); // 获得 tagName,attrs\n      if (startTagMatch) {\n        start(startTagMatch.tagName, startTagMatch.attrs);\n        continue;\n      }\n    }\n    let text;\n    if (testEnd >= 0) {\n      text = html.substring(0, testEnd);\n    }\n    if (text) {\n      advance(text.length);\n      chars(text);\n    }\n\n    // End tag:\n    const endTagMatch = html.match(endTag);\n    if (endTagMatch) {\n      advance(endTagMatch[0].length);\n      end(endTagMatch[1]);\n      continue;\n    }\n\n    // Doctype:\n    const doctypeMatch = html.match(doctype);\n    if (doctypeMatch) {\n      advance(doctypeMatch[0].length);\n      continue;\n    }\n    // Comment:\n    if (comment.test(html)) {\n      const commentEnd = html.indexOf('-->');\n\n      if (commentEnd >= 0) {\n        if (options.shouldKeepComment) {\n          options.comment(\n            html.substring(4, commentEnd),\n            index,\n            index + commentEnd + 3\n          );\n        }\n        advance(commentEnd + 3);\n        continue;\n      }\n    }\n  }\n\n  // 截取\n  /**\n   * vue 在匹配过程中，一旦找到该节点后，就将其截取调\n   *  <div id=\"app\"><p>hello</p></div>\n   * 匹配`<div`成功后， 截取，变成\n   * id=\"app\"><p>hello</p></div>， 依次，直到结束\n   */\n  function advance(n) {\n    html = html.substring(n);\n  }\n\n  function parseStartTag() {\n    const start = html.match(startTagOpen);\n    if (start) {\n      const match = {\n        tagName: start[1],\n        attrs: [],\n      };\n      advance(start[0].length);\n      let end, attr;\n      // 结束标签> 不存在，并且有属性\n      while (\n        !(end = html.match(startTagClose)) &&\n        (attr = html.match(dynamicArgAttribute) || html.match(attribute))\n      ) {\n        advance(attr[0].length);\n        match.attrs.push({\n          name: attr[1],\n          value: attr[3] || attr[4] || attr[5] || '',\n        });\n      }\n      if (end) {\n        advance(end[0].length);\n        return match;\n      }\n    }\n  }\n\n  return root;\n}\n","const defaultTagRE = /\\{\\{((?:.|\\r?\\n)+?)\\}\\}/g;\n\n/**\n * 字符拼接称 _c('div', {background: red}, _C(), _c())\n */\nexport function generate(ast) {\n  const code = ast ? genElement(ast) : '_c(\"div\")';\n\n  return code;\n}\n\nexport function genElement(el) {\n  let code = `_c(\n    '${el.tag}', \n    ${el.attrsList.length ? genProps(el.attrsList) : 'undefined'},\n    ${genChildren(el.children)}\n  )`;\n  return code;\n}\n/**\n * 处理属性，拼接成属性的字符串\n */\nfunction genProps(attrs) {\n  let str = '';\n  attrs.forEach((item) => {\n    if (item.name === 'style') {\n      let obj = {};\n      // style=\"color: red\" => style: {\"color: red\"}\n      item.value.split(';').forEach((c) => {\n        let [key, value] = c.split(':');\n        obj[key] = value.replace(/\\s/g, '');\n      });\n      item.value = obj;\n    }\n    // if(item.name === 'className') ....\n    str += `${item.name}:${JSON.stringify(item.value)},`;\n  });\n\n  return `{${str.slice(0, -1)}}`;\n}\nfunction genChildren(children) {\n  if (children && children.length) {\n    return children.map((child) => gen(child)).join(',');\n  } else {\n    return false;\n  }\n}\nfunction gen(node) {\n  // 元素\n  if (node.type === 1) return generate(node);\n  // 文本\n  // 正则的 lastIndex https://zhuanlan.zhihu.com/p/147665861\n  let text = node.text; // hello, {{message}}, hello\n  let tokens = [];\n  let match, index;\n  let lastIndex = (defaultTagRE.lastIndex = 0);\n\n  while ((match = defaultTagRE.exec(text))) {\n    index = match.index;\n    // push text token\n    if (index > lastIndex) {\n      tokens.push(JSON.stringify(text.slice(lastIndex, index)));\n    }\n    // tag token\n    tokens.push(`_s(${match[1].trim()})`);\n    lastIndex = index + match[0].length;\n  }\n  if (lastIndex < text.length) {\n    tokens.push(JSON.stringify(text.slice(lastIndex)));\n  }\n\n  return `_v(${tokens.join('+')})`;\n}\n","// vue 模版编译靠的是正则\nimport { parseHTML } from './parser/html-parser';\nimport { generate } from './codegen/index';\n\nexport function compileToFunctions(template) {\n  // 1)html => ast 语法树\n  let ast = parseHTML(template);\n\n  // 2)ast => render，即模版引擎的实现（本质字符串拼接）如下：\n  // <div id=\"app\"><p>hello{{message}}</div>\n  // _c('div', {id: add}), _c('p', undefine, _v('hello' + _s('message'), _c(), _c()...))\n  let code = generate(ast);\n  // 3) 创建 render Function\n  let renderFunction = new Function(`\n    with(this) { \n      return ${code}\n    }\n  `);\n\n  return renderFunction;\n}\n","let queue = [];\nlet has = {}; // new Set() 会更好\nexport function queueWatcher(watcher) {\n  const id = watcher.id;\n\n  if (has[id] == null) {\n    has[id] = true;\n    queue.push(watcher);\n\n    // nextTick(flushSchedulerQueue)\n    setTimeout(() => {\n      queue.forEach((watcher) => watcher.run());\n      queue = [];\n      has = {};\n    }, 0);\n  }\n}\n","import Dep, { pushTarget, popTarget } from './dep';\nimport { queueWatcher } from './scheduler';\n\nlet uid = 0;\n\nexport default class Watcher {\n  constructor(vm, expOrFn, cb, options) {\n    this.vm = vm;\n    this.cb = cb;\n    this.id = ++uid;\n    this.getter = expOrFn;\n    this.depIds = new Set();\n\n    this.get();\n  }\n  get() {\n    pushTarget(this);\n    this.getter();\n    popTarget();\n  }\n  update() {\n    console.log(this.vm);\n    // this.get();\n    queueWatcher(this); // 将watcher 放入queueWatcher中\n  }\n  addDep(dep) {\n    // dep 和 watcher 多对多的关系\n    const id = dep.id;\n\n    if (!this.depIds.has(id)) {\n      dep.addSub(this);\n    }\n  }\n  run() {\n    this.get();\n  }\n}\n","function sameVnode(a, b) {\n  return a.key === b.key && a.tag === b.tag;\n}\n\nexport function patch(oldVNode, vNode) {\n  const isRealElement = oldVNode.nodeType;\n\n  if (isRealElement) {\n    // 首次渲染  mounting to a real element\n    const oldElm = oldVNode; // div id=\"app\"\n    const parentElm = oldElm.parentNode; // 父节点\n\n    let el = createElm(vNode);\n    parentElm.insertBefore(el, oldElm.nextSibling);\n    parentElm.removeChild(oldElm);\n  } else {\n    // 更新\n    patchVnode(oldVNode, vNode);\n  }\n  return vNode.el;\n}\n\nfunction patchVnode(oldVNode, vNode) {\n  if (oldVNode === vNode) {\n    return;\n  }\n  // 1) 现比较标签一不一样 div 变 p\n  if (oldVNode.tag !== vNode.tag) {\n    // 替换儿子，必须通过父亲\n    oldVNode.el.parentNode.replaceChild(createElm(vNode), oldVNode.el);\n  }\n  // 2）比较文本 标签一样可能是都是undefined\n  if (!oldVNode.tag) {\n    if (oldVNode.text !== vNode.text) {\n      // 内容不一致，直接替换文本\n      oldVNode.el.textContent = vNode.text;\n    }\n  }\n  // 3）如果标签一样 属性不一样\n  let el = (vNode.el = oldVNode.el);\n  updateProperties(vNode, oldVNode.data);\n\n  // 4）比较孩子\n  let oldChildren = oldVNode.children || [];\n  let newChildren = vNode.children || [];\n\n  if (oldChildren.length > 0 && newChildren.length > 0) {\n    // 4.1）新老都有孩子\n    updateChildren(el, oldChildren, newChildren);\n  } else if (oldChildren.length > 0) {\n    // 4.2) 老有孩子, 新的没有孩子\n    el.innerHTML = '';\n  } else {\n    // 4.3) 新有孩子, 老的没有孩子\n    for (let i = 0; i < newChildren.length; i++) {\n      let child = newChildren[i];\n      el.appendChild(createElm(child));\n    }\n  }\n}\n/**\n * vue 增加了许多优化策略，\n * 在浏览器中，最常用的方法有 1）开头结尾插入 2）正序倒序\n *\n * vue 的 domDiff 利用了双指针\n */\nfunction updateChildren(parentElm, oldCh, newCh) {\n  let oldStartIdx = 0;\n  let oldEndIdx = oldCh.length - 1;\n  let oldStartVnode = oldCh[0];\n  let oldEndVnode = oldCh[oldEndIdx];\n  let newStartIdx = 0;\n  let newEndIdx = newCh.length - 1;\n  let newStartVnode = newCh[0];\n  let newEndVnode = newCh[newEndIdx];\n  let oldKeyToIdxMap, oldIndexByKey;\n\n  while (oldStartIdx <= oldEndIdx && newStartIdx <= newEndIdx) {\n    if (!oldStartVnode) {\n      oldStartVnode = oldCh[++oldStartIdx];\n    } else if (!oldEndVnode) {\n      oldEndVnode = oldCh[--oldEndIdx];\n    } else if (sameVnode(oldStartVnode, newStartVnode)) {\n      // 老队列的头部节点 和 新队列的头部节点 一样\n      patchVnode(oldStartVnode, newStartVnode);\n      oldStartVnode = oldCh[++oldStartIdx];\n      newStartVnode = newCh[++newStartIdx];\n    } else if (sameVnode(oldEndVnode, newEndVnode)) {\n      // 老队列的尾部节点 和 新队列的尾部节点 一样\n      patchVnode(oldEndVnode, newEndVnode);\n      oldEndVnode = oldCh[--oldEndIdx];\n      newEndVnode = newCh[--newEndIdx];\n    } else if (sameVnode(oldStartVnode, newEndVnode)) {\n      // 老队列的头部节点 和 新队列的尾部节点 一样\n      patchVnode(oldStartVnode, newEndVnode);\n      // 将老队列的头部节点，插入到 老队列的尾部节点后面（每次都是插入到老队列的尾部节点）\n      // ABCD=> DCBA, 1)BCD A 2)CD BA 3) D CBA 4)  DCBA\n      parentElm.insertBefore(oldStartVnode.el, oldEndVnode.el.nextSibling);\n      oldStartVnode = oldCh[++oldStartIdx];\n      newEndVnode = newCh[--newEndIdx];\n    } else if (sameVnode(oldEndVnode, newStartVnode)) {\n      // 老队列的尾部节点 和 新队列的头部节点 一样\n      // ABCD => DABC\n      patchVnode(oldEndVnode, newStartVnode);\n      parentElm.insertBefore(oldEndVnode.el, oldStartVnode.el);\n      oldEndVnode = oldCh[--oldEndIdx];\n      newStartVnode = newCh[++newStartIdx];\n    } else {\n      // 乱序\n      oldKeyToIdxMap = createKeyToOldIdx(oldCh);\n      oldIndexByKey = oldKeyToIdxMap[newStartVnode.key];\n\n      if (oldIndexByKey == null) {\n        // 此元素在老序列中没有找到，需要在头部插入\n        parentElm.insertBefore(createElm(newStartVnode), oldStartVnode.el);\n      } else {\n        let oldVNodeToMove = oldCh[oldIndexByKey];\n        if (oldVNodeToMove.tag !== newStartVnode.tag) {\n          parentElm.insertBefore(createElm(newStartVnode));\n        } else {\n          // 移动\n          patchVnode(oldVNodeToMove, newStartVnode);\n          // 移动后设置为空\n          oldCh[oldIndexByKey] = undefined;\n          parentElm.insertBefore(oldVNodeToMove.el, oldStartVnode.el);\n        }\n      }\n      newStartVnode = newCh[++newStartIdx];\n    }\n  }\n\n  if (newStartIdx <= newEndIdx) {\n    // 添加节点\n    // insertBefore(el1, el2), 如果将要插入的节点， el2 = null, 等价与 appendChild\n    // el: 我要把这个节点插入到谁的前面\n    let ele = newCh[newEndIdx + 1] == null ? null : newCh[newEndIdx + 1].el;\n\n    for (let i = newStartIdx; i <= newEndIdx; i++) {\n      parentElm.insertBefore(createElm(newCh[i]), ele);\n    }\n  }\n\n  if (oldStartIdx <= oldEndIdx) {\n    // 删除\n    for (let i = oldStartIdx; i <= oldEndIdx; i++) {\n      if (oldCh[i] != undefined) {\n        parentElm.removeChild(oldCh[i].el);\n      }\n    }\n  }\n}\n\nfunction createKeyToOldIdx(children) {\n  const map = {};\n  for (let i = 0; i <= children.length; i++) {\n    let key = children[i] && children[i].key;\n    if (key) map[key] = i;\n  }\n  return map;\n}\n\n// 把虚拟 dom 变成真实dom\nexport function createElm(vNode) {\n  const { children, tag, data, key, text } = vNode;\n\n  // 标签\n  if (typeof tag === 'string') {\n    vNode.el = document.createElement(tag);\n    updateProperties(vNode);\n    // 递归创建子节点\n    if (Array.isArray(children)) {\n      children.forEach((child) => vNode.el.appendChild(createElm(child)));\n    }\n  } else {\n    vNode.el = document.createTextNode(text);\n  }\n  return vNode.el;\n}\n\n/**\n * 更新属性\n */\nfunction updateProperties(vNode, oldProps = {}) {\n  const newProps = vNode.data || {};\n  const el = vNode.el;\n\n  const newStyle = newProps.style || [];\n  const oldStyle = oldProps.style || [];\n\n  for (let styleName in oldStyle) {\n    if (!newStyle[styleName]) {\n      el.style[styleName] = '';\n    }\n  }\n\n  for (let key in oldProps) {\n    if (!newProps[key]) {\n      delete el[key];\n    }\n  }\n\n  for (let key in newProps) {\n    if (key === 'style') {\n      for (let styleName in newProps.style) {\n        el.style[styleName] = newProps.style[styleName];\n      }\n    } else if (key === 'class') {\n      el.class = newProps.className;\n    } else {\n      el.setAttribute(key, newProps[key]);\n    }\n  }\n}\n","import Watcher from '../observer/watcher';\nimport { patch, createElm } from '../vdom/patch';\n/**\n * vnode 渲染成为真实的节点\n */\nexport function lifecycleMixin(Vue) {\n  Vue.prototype._update = function (vNode) {\n    const vm = this;\n    const el = vm.$el; // 真实节点\n    const prevVNode = vm._vNode; // 上一次的虚拟节点\n    if (!prevVNode) {\n      // 首次挂载\n      vm._vNode = vNode;\n      patch(el, vNode);\n    } else {\n      // 更新\n      vm.$el = patch(prevVNode, vNode);\n    }\n\n    return;\n  };\n}\n\nexport function callHook(vm, hook) {\n  const handlers = vm.$options[hook];\n  if (handlers) {\n    for (let i = 0, l = handlers.length; i < l; i++) {\n      return handlers[i];\n    }\n  }\n}\n\nexport function mountComponent(vm, el) {\n  const options = vm.$options;\n  vm.$el = el; // 挂载后，$el 就保存了真实dom节点信息\n\n  // callHook(vm, 'beforeMount')\n  /**\n   * 1）渲染\n   * 核心之一， 先render后update, 无论是更新还是创建都需要这个函数\n   * _render 调用 Vue 上的 render 方法，生成虚拟节点\n   * _update 通过 vnode, 创建真实的节点\n   */\n\n  let updateComponent = () => {\n    vm._update(vm._render());\n  };\n  /**\n   * 2）渲染 Watcher， 每一个组建都有一个 Watcher\n   */\n  new Watcher(vm, updateComponent, () => {}, true /* isRenderWatcher */);\n  return vm;\n}\n","/**\n * createElement, createTextNode 是用来实现虚拟节点的\n * template => ast => render => vnode => real node\n */\nexport function h(tag, data = {}, ...children) {\n  children = children.map((child) =>\n    typeof child == 'string' || typeof child == 'number'\n      ? createTextNode(child)\n      : child\n  );\n\n  return createElement(tag, data, ...children);\n\n  // if (tag) {\n  //   if (typeof children[0] == 'string' || typeof children[0] == 'number') {\n  //     children[0] = createTextNode(children[0]);\n  //   }\n  //   vnode = createElement(tag, data, ...children);\n  // }\n  // return vnode;\n}\nexport function createElement(tag, data = {}, ...children) {\n  let key = data.key;\n  if (key) delete data.key;\n  return vnode(tag, data, key, children, undefined);\n}\n\nexport function createTextNode(text) {\n  return vnode(undefined, undefined, undefined, undefined, text);\n}\n\nexport function vnode(tag, data, key, children, text, el) {\n  return {\n    _type: 'VNODE_TYPE',\n    tag,\n    data,\n    key,\n    children,\n    text,\n    el, // 真实节点\n  };\n}\n","import { initState } from './state';\nimport { compileToFunctions } from '../compiler/index';\nimport { mountComponent } from './lifecycle';\nimport { h } from '../vdom/create-element';\n\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n\n    // 初始化数据\n    initState(vm);\n\n    // 如果用户传入el需要将页面渲染出来\n    if (vm.$options.el) {\n      vm.$mount(vm.$options.el);\n    }\n  };\n  Vue.prototype.$mount = function (el) {\n    const vm = this;\n    const options = vm.$options;\n    if (typeof el == 'string') {\n      el = document.querySelector(el);\n    }\n\n    // 默认先找render方法，在找template，如果都没有就使用el\n    // 1) 首先 把 模版转成 render函数\n    if (!options.render) {\n      let template = options.template;\n      if (!template && el) {\n        template = getOuterHTML(el);\n      }\n      // 我们需要将template转成render ，以便 虚拟dom使用\n      let render = compileToFunctions(template);\n      options.render = render;\n    } else {\n      let render = options.render;\n      options.render = () => render(h);\n    }\n    // 2）挂载组件\n    console.log(options);\n    return mountComponent(vm, el);\n  };\n}\n\nfunction getOuterHTML(el) {\n  if (el.outerHTML) {\n    return el.outerHTML;\n  } else {\n    const container = document.createElement('div');\n    container.appendChild(el.cloneNode(true));\n    return container.innerHTML;\n  }\n}\n","import { createElement, createTextNode } from '../vdom/create-element';\nimport { h } from '../vdom/create-element';\nexport function renderMixin(Vue) {\n  /**\n   * 创建元素的虚拟节点\n   */\n  Vue.prototype._c = function () {\n    return createElement(...arguments);\n  };\n  /**\n   * 创建文本的虚拟节点\n   */\n  Vue.prototype._v = function (text) {\n    return createTextNode(text);\n  };\n  /**\n   * json.stringify\n   */\n  Vue.prototype._s = function (value) {\n    return value == null\n      ? ''\n      : typeof value === 'object'\n      ? JSON.stringify(value)\n      : value;\n  };\n  // 调用 Vue 上的 render 方法，生成虚拟节点\n  Vue.prototype._render = function () {\n    const vm = this;\n\n    const { render } = vm.$options;\n\n    return render.call(vm, h);\n  };\n}\n\nexport function initRender(vm) {\n  console.log(vm);\n}\n","import { initMixin } from './init';\nimport { renderMixin } from './render';\nimport { lifecycleMixin } from './lifecycle';\n\nfunction Vue(options) {\n  this._init(options);\n}\n\ninitMixin(Vue);\nrenderMixin(Vue);\nlifecycleMixin(Vue);\n\nexport default Vue;\n"],"names":["isObject","obj","def","key","val","enumerable","Object","defineProperty","value","writable","configurable","arrayProto","Array","prototype","arrayMethods","create","methodsToPatch","forEach","method","original","args","result","apply","ob","__ob__","inserted","slice","observeArray","dep","notify","uid","Dep","id","subs","sub","push","remove","target","addDep","i","l","length","update","targetStack","pushTarget","watcher","popTarget","pop","observe","Observer","isArray","__proto__","walk","keys","defineReactive","items","childOb","get","reactiveGetter","depend","dependArray","set","reactiveSetter","newVal","console","log","e","proxy","vm","source","newValue","initState","opts","$options","props","initProps","methods","initMethods","data","initData","computed","initComputed","watch","initWatch","_data","call","ncname","qnameCapture","startTagOpen","RegExp","startTagClose","endTag","dynamicArgAttribute","attribute","doctype","comment","parseHTML","html","options","root","currentParent","stack","createASTElement","tag","attrs","type","attrsList","parent","children","start","element","chars","text","replace","end","testEnd","indexOf","startTagMatch","parseStartTag","tagName","substring","advance","endTagMatch","match","doctypeMatch","test","commentEnd","shouldKeepComment","index","n","attr","name","defaultTagRE","generate","ast","code","genElement","el","genProps","genChildren","str","item","split","c","JSON","stringify","map","child","gen","join","node","tokens","lastIndex","exec","trim","compileToFunctions","template","renderFunction","Function","queue","has","queueWatcher","setTimeout","run","Watcher","expOrFn","cb","getter","depIds","Set","addSub","sameVnode","a","b","patch","oldVNode","vNode","isRealElement","nodeType","oldElm","parentElm","parentNode","createElm","insertBefore","nextSibling","removeChild","patchVnode","replaceChild","textContent","updateProperties","oldChildren","newChildren","updateChildren","innerHTML","appendChild","oldCh","newCh","oldStartIdx","oldEndIdx","oldStartVnode","oldEndVnode","newStartIdx","newEndIdx","newStartVnode","newEndVnode","oldKeyToIdxMap","oldIndexByKey","createKeyToOldIdx","oldVNodeToMove","undefined","ele","document","createElement","createTextNode","oldProps","newProps","newStyle","style","oldStyle","styleName","className","setAttribute","lifecycleMixin","Vue","_update","$el","prevVNode","_vNode","mountComponent","updateComponent","_render","h","vnode","_type","initMixin","_init","$mount","querySelector","render","getOuterHTML","outerHTML","container","cloneNode","renderMixin","_c","arguments","_v","_s"],"mappings":"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"}